function calculatePrice() {
    const hours = parseFloat(document.getElementById('hours').value);
    const materialCosts = document.querySelectorAll('.material-cost');
    let totalMaterialCost = 0;
    let totalMaterialProfit = 0;

    materialCosts.forEach(input => {
        const cost = parseFloat(input.value);
        if (!isNaN(cost) && cost > 0) {
            totalMaterialCost += cost;

            // Calculate profit margin based on the cost
            let profitMargin;
            if (cost <= 500) {
                profitMargin = 0.12; // 12%
            } else if (cost <= 1500) {
                profitMargin = 0.08; // 8%
            } else if (cost <= 3000) {
                profitMargin = 0.05; // 5%
            } else {
                profitMargin = 0.03; // 3%
            }

            totalMaterialProfit += cost * profitMargin;
        }
    });

    if (isNaN(hours) || hours <= 0) {
        alert("Please enter a valid number of hours.");
        return;
    }

    // Check if there are valid material costs
    if (totalMaterialCost <= 0) {
        alert("Please enter at least one valid material cost.");
        return;
    }

    // Calculate costs
    const laborCost = hourlyRate * hours;
    const laborProfit = laborCost * 0.18; // 20% profit on labor
    const totalCost = laborCost + totalMaterialCost;
    const totalPrice = totalCost + totalMaterialProfit + laborProfit;

    // Display cost before profit and total price with profit
    document.getElementById('total-info').innerText = `السعر:  QR ${totalPrice.toFixed(2)}`;

    // Generate receipt with profit details
    generateReceipt(hours, totalMaterialCost, laborCost, totalCost, totalPrice, laborProfit);
}
function generateReceipt(hours, totalMaterialCost, laborCost, totalCost, totalPrice, laborProfit) {
    const materialCostElements = document.querySelectorAll('.material-cost');
    let materialDetails = '';

    materialCostElements.forEach(input => {
        const cost = parseFloat(input.value);
        if (!isNaN(cost) && cost > 0) {
            let profitMargin;
            if (cost <= 500) {
                profitMargin = 0.12; // 12%
            } else if (cost <= 1500) {
                profitMargin = 0.08; // 8%
            } else if (cost <= 3000) {
                profitMargin = 0.05; // 5%
            } else {
                profitMargin = 0.03; // 3%
            }
            const profit = cost * profitMargin;
            materialDetails += `تكلفة مادة: QR ${cost.toFixed(2)}, ربح: QR ${profit.toFixed(2)}\n`;
        }
    });

    if (materialDetails === '') {
        materialDetails = 'لا توجد تكاليف مواد.\n'; // Message for no material costs
    }

    document.getElementById('receipt-hours').innerText = `ساعات العمل: ${hours} ساعة`;
    document.getElementById('receipt-materials').innerText = `تكلفة المواد: QR ${totalMaterialCost.toFixed(2)}`;
    document.getElementById('receipt-labor-cost').innerText = `تكلفة العمل: QR ${laborCost.toFixed(2)} (ربح: QR ${laborProfit.toFixed(2)})`;
    document.getElementById('receipt-total-price').innerText = `السعر الإجمالي: QR ${totalPrice.toFixed(2)}`;

    document.getElementById('receipt').style.display = 'block'; // Show the receipt
}
